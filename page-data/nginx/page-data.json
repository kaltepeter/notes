{"componentChunkName":"component---src-templates-note-template-tsx","path":"/nginx/","result":{"data":{"markdownRemark":{"html":"<p>proxying - <a href=\"https://www.digitalocean.com/community/tutorials/understanding-nginx-http-proxying-load-balancing-buffering-and-caching\">https://www.digitalocean.com/community/tutorials/understanding-nginx-http-proxying-load-balancing-buffering-and-caching</a></p>\n<p><a href=\"https://www.digitalocean.com/community/tutorials/understanding-nginx-server-and-location-block-selection-algorithms\">https://www.digitalocean.com/community/tutorials/understanding-nginx-server-and-location-block-selection-algorithms</a> - matching algorithms</p>\n<p><a href=\"https://www.digitalocean.com/community/tutorials/how-to-set-up-nginx-server-blocks-virtual-hosts-on-ubuntu-16-04\">https://www.digitalocean.com/community/tutorials/how-to-set-up-nginx-server-blocks-virtual-hosts-on-ubuntu-16-04</a> - manager server blocks</p>\n<p><a href=\"https://www.linode.com/docs/web-servers/nginx/how-to-configure-nginx/\">https://www.linode.com/docs/web-servers/nginx/how-to-configure-nginx/</a></p>\n<h3>headers</h3>\n<pre><code class=\"language-text\">proxy_set_header X-Real-IP  $remote_addr;\nproxy_set_header X-Forwarded-For $remote_addr;\nproxy_set_header Host $host;\n</code></pre>\n<h3>env vars in config</h3>\n<p><a href=\"https://docs.docker.com/samples/library/nginx/#using-environment-variables-in-nginx-configuration\">https://docs.docker.com/samples/library/nginx/#using-environment-variables-in-nginx-configuration</a></p>\n<ol>\n<li>\n<p>Create upstreams.conf.template. wrap vars with ${}</p>\n<pre><code class=\"language-text\">upstream jaasmanda {\n    server ${JAAS_MANDA};\n}\n</code></pre>\n</li>\n<li>\n<p>process vars. will copy processed to /etc/nginx/snippets/upstreams.conf</p>\n<pre><code class=\"language-text\">export JAAS_MANDA=$(ip route | grep default | cut -d ' ' -f 3):8080\nenvsubst &#x3C; /etc/nginx/conf.d/upstreams.conf.template > /etc/nginx/snippets/upstreams.conf &#x26;&#x26; nginx -g 'daemon off;'\n</code></pre>\n</li>\n<li>\n<p>include upstreams.conf in nginx.conf</p>\n<pre><code class=\"language-text\">include /etc/nginx/snippets/upstreams.conf;\n</code></pre>\n</li>\n</ol>\n<h2>microservices</h2>\n<p><a href=\"https://www.nginx.com/blog/building-microservices-using-an-api-gateway/\">https://www.nginx.com/blog/building-microservices-using-an-api-gateway/</a></p>\n<h2>install on ubuntu 14.04 (trsusty)</h2>\n<p><a href=\"https://www.phusionpassenger.com/library/install/nginx/install/oss/trusty/\">https://www.phusionpassenger.com/library/install/nginx/install/oss/trusty/</a></p>\n<pre><code class=\"language-bash\">sudo apt-get install -y dirmngr gnupg\nsudo apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv-keys 561F9B9CAC40B2F7\n#sudo apt-key adv --recv-keys --keyserver keyserver.ubuntu.com 16126D3A3E5C1192\n\nsudo apt-get install -y apt-transport-https ca-certificates\n\n#sudo sh -c 'echo deb https://oss-binaries.phusionpassenger.com/apt/passenger trusty main > /etc/apt/sources.list.d/passenger.list'\n\nsudo sh -c 'echo deb https://oss-binaries.phusionpassenger.com/apt/passenger/4 trusty main > /etc/apt/sources.list.d/passenger.list'\n\n\nsudo apt-get update\n\n#sudo apt-get install nginx-common\nsudo apt-get install nginx nginx-extras passenger\n</code></pre>","frontmatter":{"date":"January 14, 2021","title":"NGINX","tags":null}}},"pageContext":{"slug":"/nginx/"}},"staticQueryHashes":["1796642556","2356112386","3489759178"],"slicesMap":{}}