{"componentChunkName":"component---src-templates-note-template-tsx","path":"/workshops/mammoth-interactive/algorithmic-trading-with-python-statistics-pandas/","result":{"data":{"markdownRemark":{"html":"<p><a href=\"https://iexcloud.io/console/home\">https://iexcloud.io/console/home</a>\n<a href=\"https://iexcloud.io/docs/core/QUOTE\">https://iexcloud.io/docs/core/QUOTE</a></p>\n<h2>API Calls</h2>\n<p>Slow version</p>\n<pre><code class=\"language-python\">stocks_columns = ['Ticker', 'Price', 'Market Capitalization', 'Shares to Buy']\nstocks_dataframe = pandas.DataFrame(columns=stocks_columns)\n\nfor symbol in stocks_table['Symbol']:\n  api_url = f\"https://api.iex.cloud/v1/data/core/quote/{symbol}?token={IEX_CLOUD_API_TOKEN}\"\n  data = requests.get(api_url).json()[0]\n  print(data)\n\n  stocks_dataframe = stocks_dataframe.append(pandas.Series([symbol,\n                                                          data['latestPrice'],\n                                                          data['marketCap'],\n                                                          'N/A'],\n                                                          index=stocks_columns),\n                                            ignore_index = True)\n\nprint(stocks_dataframe)\n</code></pre>\n<p>Batching</p>\n<pre><code class=\"language-python\">def split_list(list, number_per_group: int):\n  for index in range(0, len(list), number_per_group):\n    yield list[index:index+ number_per_group]\n\nstock_symbol_groups = list(split_list(stocks_table['Symbol'], 100))\nprint(stock_symbol_groups)\n\nstock_symbol_strings = []\n\nfor index in range(0, len(stock_symbol_groups)):\n  stock_symbol_strings.append(','.join(stock_symbol_groups[index]))\n\n\n</code></pre>\n<p>Write to Excel</p>\n<p><a href=\"https://xlsxwriter.readthedocs.io/getting_started.html\">https://xlsxwriter.readthedocs.io/getting_started.html</a></p>\n<pre><code class=\"language-python\">!pip install XlsxWriter\n\nimport xlsxwriter\n\nexcel_writer = pandas.ExcelWriter('stocks.xlsx', engine='xlsxwriter')\n\nbatch_stocks_dataframe.to_excel(excel_writer, sheet_name=\"S&#x26;P 500 Stocks\", index = False)\nexcel_writer.save()\n</code></pre>","frontmatter":{"date":"January 25, 2024","title":"Algorithmic Trading with Python, Statistics, and Pandas","tags":["machine-learning","course","mammoth-interactive"]}}},"pageContext":{"slug":"/workshops/mammoth-interactive/algorithmic-trading-with-python-statistics-pandas/"}},"staticQueryHashes":["1796642556","2356112386","3489759178"],"slicesMap":{}}