{"componentChunkName":"component---src-templates-note-template-tsx","path":"/jenkins/","result":{"data":{"markdownRemark":{"html":"<h3>automation</h3>\n<p><a href=\"https://github.com/arangamani/jenkins_api_client\">https://github.com/arangamani/jenkins_api_client</a> - ruby libraries</p>\n<p><a href=\"https://jenkins.io/doc/book/managing/cli/\">https://jenkins.io/doc/book/managing/cli/</a> - cli</p>\n<p><a href=\"https://wiki.jenkins.io/display/JENKINS/Figuring+out+URL+binding+of+Stapler\">https://wiki.jenkins.io/display/JENKINS/Figuring+out+URL+binding+of+Stapler</a> - uri bindings investigation</p>\n<p><a href=\"https://github.com/kohsuke/jenkins/tree/55203ebeed1b7e182878d3e3c1184ac042f20473/core/src/main/java/hudson/cli\">https://github.com/kohsuke/jenkins/tree/55203ebeed1b7e182878d3e3c1184ac042f20473/core/src/main/java/hudson/cli</a> - cli repos</p>\n<p><a href=\"http://javadoc.jenkins-ci.org/\">http://javadoc.jenkins-ci.org/</a> - java doc</p>\n<p><a href=\"https://github.com/jenkinsci/credentials-plugin/blob/master/src/main/java/com/cloudbees/plugins/credentials/cli/UpdateCredentialsByXmlCommand.java\">https://github.com/jenkinsci/credentials-plugin/blob/master/src/main/java/com/cloudbees/plugins/credentials/cli/UpdateCredentialsByXmlCommand.java</a> - update credentials code</p>\n<p>{jenkins_server}/cli/ - cli docs</p>\n<p><a href=\"https://github.com/jenkinsci/job-dsl-plugin/wiki\">https://github.com/jenkinsci/job-dsl-plugin/wiki</a> - example dsl configuartions</p>\n<p><a href=\"http://unethicalblogger.com/2017/07/24/groovy-automation-for-jenkins.html\">http://unethicalblogger.com/2017/07/24/groovy-automation-for-jenkins.html</a> - groovy jenkins config</p>\n<p><a href=\"http://www.greenreedtech.com/creating-jenkins-credentials-via-the-rest-api/\">http://www.greenreedtech.com/creating-jenkins-credentials-via-the-rest-api/</a> - example of automating credentials</p>\n<p><a href=\"http://www.tsbakker.nl/jenkins.html\">http://www.tsbakker.nl/jenkins.html</a> - automation with CLI</p>\n<p><a href=\"https://github.com/sheehan/job-dsl-gradle-example/tree/master/src/jobs\">https://github.com/sheehan/job-dsl-gradle-example/tree/master/src/jobs</a> automating jobs</p>\n<h4>credentials</h4>\n<p><a href=\"http://www.greenreedtech.com/creating-jenkins-credentials-via-the-rest-api/\">http://www.greenreedtech.com/creating-jenkins-credentials-via-the-rest-api/</a> - create credentials via REST</p>\n<h3>Github</h3>\n<p><a href=\"https://support.cloudbees.com/hc/en-us/articles/224621668-GitHub-User-Scopes-and-Organization-Permission\">h</a><a href=\"https://support.cloudbees.com/hc/en-us/articles/224621668-GitHub-User-Scopes-and-Organization-Permission\">ttps://support.cloudbees.com/hc/en-us/articles/224621668-GitHub-User-Scopes-and-Organization-Permission</a> - scopes needed</p>\n<p><a href=\"https://jenkins.io/solutions/github/\">https://jenkins.io/solutions/github/</a> - current integration doc</p>\n<p><a href=\"https://support.cloudbees.com/hc/en-us/articles/224543927-GitHub-webhook-configuration\">https://support.cloudbees.com/hc/en-us/articles/224543927-GitHub-webhook-configuration</a> - webhooks</p>\n<h2>builds</h2>\n<p>wrapping a process in try/catch will not fail the build on exit 1</p>\n<h2>docker runs</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/notes/static/43146a837d2cece285c505565b06371c/c3fd4/speed-first-and-second-run.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 36.809815950920246%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABGElEQVR42nWQ226DMBBE+/8fmL4QDAHfmgTjuGBMIKeypVatREdajXZlnZ31m/ceay3Zv/V6vVjXlZQS+77zfD5Lv21bqTzLfqS3300GZWVQVVWc3k/M84wxmro+l/k0TTjnWJZYwIfADMqPY4zFQ/jEaotRBjc4brcRa+/4MWC0oWs7Rjf+BPgDdCGirwMhPMr2JS7c/B1xbUp1g6S+aaqronOa5tpyNjXaGXgdnLysK9p+IKUsp2T55BFzg5gaZJJ87Ba7GcxmaOOFehLoaGA/AA4hYu4jj4cv/1WAywMxtbRzRx8lclX0SSGTpp0uNHOLmvRxwphWlDb0fc/4nXDx1J8CEXJChfCCaqhQSdHOF+ogMP8k/AJygRsL2pHtqQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"speed first and second run\"\n        title=\"\"\n        src=\"/notes/static/43146a837d2cece285c505565b06371c/a6d36/speed-first-and-second-run.png\"\n        srcset=\"/notes/static/43146a837d2cece285c505565b06371c/222b7/speed-first-and-second-run.png 163w,\n/notes/static/43146a837d2cece285c505565b06371c/ff46a/speed-first-and-second-run.png 325w,\n/notes/static/43146a837d2cece285c505565b06371c/a6d36/speed-first-and-second-run.png 650w,\n/notes/static/43146a837d2cece285c505565b06371c/c3fd4/speed-first-and-second-run.png 854w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>only defined step is 'Test'. declarative auto created steps</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/notes/static/729cb4ebfdf8410ada26f6cadc5626dd/6db71/declarative-auto-steps.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 15.337423312883436%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAgElEQVR42nWP2QrEIAxF/f8fFLQIaqEoiHWhILbeIYJD52ECWW9yIOw4DiilsO87cs5YNsbAfd8/9fM8X53qNaO8dhn+GEFCCOCcQwiBUgqu68K2bTDGoPeO1hq894gxTo1uGIW3v4HOOUgppxO81gqtNay1E0D9eZ5IKc3vCPgBnlzn9JSpo2YAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"declarative auto steps\"\n        title=\"\"\n        src=\"/notes/static/729cb4ebfdf8410ada26f6cadc5626dd/a6d36/declarative-auto-steps.png\"\n        srcset=\"/notes/static/729cb4ebfdf8410ada26f6cadc5626dd/222b7/declarative-auto-steps.png 163w,\n/notes/static/729cb4ebfdf8410ada26f6cadc5626dd/ff46a/declarative-auto-steps.png 325w,\n/notes/static/729cb4ebfdf8410ada26f6cadc5626dd/a6d36/declarative-auto-steps.png 650w,\n/notes/static/729cb4ebfdf8410ada26f6cadc5626dd/6db71/declarative-auto-steps.png 659w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h4>shared pipelines</h4>\n<p><a href=\"https://jenkins.io/blog/2017/10/02/pipeline-templates-with-shared-libraries/\">https://jenkins.io/blog/2017/10/02/pipeline-templates-with-shared-libraries/</a></p>\n<h4>groovy tricks</h4>\n<p><a href=\"https://github.com/cloudbees/jenkins-scripts\">https://github.com/cloudbees/jenkins-scripts</a></p>\n<p><a href=\"https://github.com/tkrzeminski/jenkins-groovy-scripts\">https://github.com/tkrzeminski/jenkins-groovy-scripts</a></p>\n<p><a href=\"https://github.com/samrocketman/jenkins-bootstrap-shared/tree/master/scripts\">https://github.com/samrocketman/jenkins-bootstrap-shared/tree/master/scripts</a></p>\n<p><a href=\"https://github.com/edx/jenkins-configuration/tree/master/src/main/groovy\">https://github.com/edx/jenkins-configuration/tree/master/src/main/groovy</a></p>\n<p><a href=\"https://github.com/docker/jenkins-pipeline-scripts/tree/master/vars\">https://github.com/docker/jenkins-pipeline-scripts/tree/master/vars</a></p>\n<p><a href=\"https://github.com/blacklabelops/jenkins/tree/master/groovy\">https://github.com/blacklabelops/jenkins/tree/master/groovy</a></p>\n<p><a href=\"http://unethicalblogger.com/2017/07/24/groovy-automation-for-jenkins.html\">http://unethicalblogger.com/2017/07/24/groovy-automation-for-jenkins.html</a></p>\n<pre><code class=\"language-groovy\">println Jenkins.instance.metaClass.methods*.name.sort().unique()\n</code></pre>\n<pre><code class=\"language-groovy\">Jenkins.instance.getItems().each {it ->\n  println it.name\n}\nJenkins.instance.getComputers().eachWithIndex{ it, index ->\n  println it.name\n  println it.description\n  println it.getAllExecutors()\n\n  println it.metaClass.methods*.name.sort().unique()\n}\nprintln Jenkins.instance.metaClass.methods*.name.sort().unique()\n</code></pre>\n<h4>execute script on slave</h4>\n<p><a href=\"https://github.com/kaltepeter/notes/tree/cfd36b59cb201b8ecf6d88b3f15e467d17968139/h%20ttps:/stackoverflow.com/questions/26583979/run-a-remote-command-on-all-jenkins-slaves-via-masterss-script-console/README.md\">https://stackoverflow.com/questions/26583979/run-a-remote-command-on-all-jenkins-slaves-via-masterss-script-console </a></p>\n<pre><code class=\"language-groovy\">import hudson.util.RemotingDiagnostics;\n\nprint_ip = 'println InetAddress.localHost.hostAddress';\nprint_hostname = 'println InetAddress.localHost.canonicalHostName';\n\n// here it is - the shell command, uname as example\nuname = 'def proc = \"uname -a\".execute(); proc.waitFor(); println proc.in.text';\n\nfor (slave in hudson.model.Hudson.instance.slaves) {\n    println slave.name;\n    println RemotingDiagnostics.executeGroovy(print_ip, slave.getChannel());\n    println RemotingDiagnostics.executeGroovy(print_hostname, slave.getChannel());\n    println RemotingDiagnostics.executeGroovy(uname, slave.getChannel());\n}\n</code></pre>\n<h4>get ips of computers</h4>\n<pre><code class=\"language-text\">import hudson.model.Computer.ListPossibleNames\n\nJenkins.instance.getComputers().eachWithIndex{ it, index ->\n  println it.name\n  if (it.getChannel()) {\n      println it.getChannel().call(new ListPossibleNames())\n  }\n}\n</code></pre>\n<h3>execute bash on slave</h3>\n<p><a href=\"https://gist.github.com/hfs/68b2f124d1952233ba49\">https://gist.github.com/hfs/68b2f124d1952233ba49</a></p>\n<pre><code class=\"language-text\">import hudson.util.RemotingDiagnostics;\n\nscript = 'def proc = \"ls -1 /home\".execute(); proc.waitFor(); println proc.in.text';\n\nfor (slave in Jenkins.instance.slaves) {\n  println slave.name;\n  try {\n    println RemotingDiagnostics.executeGroovy(script, slave.getChannel());\n  } catch (all) {\n    all.printStackTrace();\n  }\n}\n</code></pre>\n<pre><code class=\"language-text\">def sout = new StringBuilder(), serr = new StringBuilder()\ndef proc = 'ls /badDir'.execute()\nproc.consumeProcessOutput(sout, serr)\nproc.waitForOrKill(1000)\nprintln \"out> $sout err> $serr\"\n\n</code></pre>\n<h4>list dirs on particular slave</h4>\n<pre><code class=\"language-text\">import hudson.util.RemotingDiagnostics;\n\ndef workspace = '/home/jenkins/jenkins_slave/workspace/ration_ds1-ui-tests_develop-LYDYDYVNXVUTNVBKZNYKHEE2HAP2OLNY36LSUVBCCMTSPUWGACXQ'\nscript = \"def proc = \\'ls -1 ${workspace}\\'.execute(); proc.waitFor(); println proc.in.text\";\n\nfor (slave in Jenkins.instance.slaves) {\n    println slave.name;\n  if (slave.name == 'us2s-slave-name-0') {\n    try {\n          println RemotingDiagnostics.executeGroovy(script, slave.getChannel());\n    } catch (all) {\n        all.printStackTrace();\n    }\n  }\n}\n</code></pre>\n<h3>Declarative pipeline</h3>\n<p><a href=\"https://gist.github.com/abayer/925c68132b67254147efd8b86255fd76\">https://gist.github.com/abayer/925c68132b67254147efd8b86255fd76</a></p>\n<p><a href=\"https://github.com/jenkinsci/pipeline-examples\">https://github.com/jenkinsci/pipeline-examples</a></p>\n<h4>Env vars</h4>\n<p><strong>Debugging</strong></p>\n<pre><code class=\"language-text\">sh 'printenv'\n</code></pre>\n<p><strong>environment block</strong></p>\n<pre><code class=\"language-text\">environment {\n            HIPCHAT_NOTIFS = credentials('HIPCHAT_NOTIFS')\n            hipchat_room = \"${pipelineParams.prNotificationRoom}\"\n//            https://github.com/jenkinsci/hipchat-plugin/issues/103 single quote hipchat tokens\n            hipchat_changes = '${HIPCHAT_CHANGES}'\n            JENKINS_TEMPLATES_URL = \"git@github.com:MyOrgName/repo-name.git\"\n        }\n</code></pre>\n<h2>kill all jobs and pending</h2>\n<p><a href=\"https://gist.github.com/realityforge/c57eb3d1854320d14252ac881fc6cedf\">https://gist.github.com/realityforge/c57eb3d1854320d14252ac881fc6cedf</a></p>\n<p>kill jobs and pending</p>\n<pre><code class=\"language-groovy\">import jenkins.model.Jenkins\n\nimport hudson.model.*\n\ndef q = Jenkins.instance.queue\n\nq.items.each { q.cancel(it.task) }\n\n\ndef cancelBuilds(root) {\n  for (job in root.items) {\n    if (!job.hasProperty('builds')) {\n      println \"job has no property builds. ${job}\"\n      cancelBuilds(job)\n\n    } else {\n      for (build in job.builds) {\n        println \"build: ${build}\"\n//        println build.metaClass.methods*.name.sort().unique()\n        //if (build == this.build) { continue; } // don't cancel ourself!\n        if (!build.hasProperty('causes')) { continue; }\n        if (!build.isBuilding()) { continue; }\n        for (cause in build.causes) {\n          println('Stopping ' + build.toString());\n          build.doStop();\n          println(build.toString() + ' stopped.');\n          break;\n        }\n      }\n    }\n  }\n}\n\ncancelBuilds(Jenkins.instance)\n</code></pre>\n<p>kill pending</p>\n<pre><code class=\"language-text\">import hudson.model.*\n\ndef q = Jenkins.instance.queue\n\nq.items.each { q.cancel(it.task) }\n</code></pre>\n<h2>running docker containers with jenkins</h2>\n<p><a href=\"https://jenkins.io/doc/book/pipeline/docker/#using-multiple-containers\">https://jenkins.io/doc/book/pipeline/docker/#using-multiple-containers</a></p>\n<h3>Multiple containers can be tricky.</h3>\n<p>If you have a top level agent an override in one stage you will get a different workspace@2 and run into a strange error:</p>\n<pre><code class=\"language-text\">OCI runtime exec failed: exec failed: container_linux.go:296: starting container process caused \"chdir to cwd\n</code></pre>\n<p>other possible issues: <a href=\"https://github.com/docker/cli/issues/297\">https://github.com/docker/cli/issues/297</a></p>\n<p><strong>Before:</strong></p>\n<pre><code class=\"language-text\">pipeline {\n    agent {\n        docker { image 'maven:3-alpine' }\n    }\n    stages {\n        stage('Back-end') {\n            steps {\n                sh 'mvn --version'\n            }\n        }\n        stage('pcf') {\n            steps {\n                sh 'cf --version'\n            }\n        }\n\n        stage('Front-end') {\n            agent {\n                docker { image 'node:7-alpine' }\n            }\n            steps {\n                sh 'node --version'\n            }\n        }\n    }\n}\n</code></pre>\n<p><strong>Solution:</strong></p>\n<pre><code class=\"language-text\">pipeline {\n    agent none\n    stages {\n        stage('Back-end') {\n            agent {\n                docker { image 'maven:3-alpine' }\n            }\n            steps {\n                sh 'mvn --version'\n            }\n        }\n        stage('pcf') {\n            agent {\n                docker { image 'maven:3-alpine' }\n            }\n\n            steps {\n                sh 'cf --version'\n            }\n        }\n        stage('Front-end') {\n            agent {\n                docker { image 'node:7-alpine' }\n            }\n            steps {\n                sh 'node --version'\n            }\n        }\n    }\n}\n</code></pre>\n<h3>Vars in docker agent block</h3>\n<p><a href=\"https://issues.jenkins-ci.org/browse/JENKINS-42369\">https://issues.jenkins-ci.org/browse/JENKINS-42369</a></p>\n<p>agent block can't access env.WORKSPACE or $HOME for instance. docker volumes must be an absolute path.</p>\n<p><strong>issue:</strong></p>\n<pre><code class=\"language-text\"> stage('deploy') {\n    agent {\n        docker {\n            image 'mrllsvc/pcf-tools:3'\n            args \"-v ${env.WORKSPACE}/:/home/pcf/tools/\"\n        }\n    }\n}\n</code></pre>\n<p><strong>workaround 1:</strong></p>\n<pre><code class=\"language-text\">stage('deploy') {\n    agent {\n        docker {\n            image 'mrllsvc/pcf-tools:3'\n            args \"-v ${WORKSPACE}/:/home/pcf/tools/\"\n        }\n    }\n    parameters {\n        string(defaultValue: '/home/jenkins/blah', description: '', name: 'WORKSPACE')\n    }\n}\n</code></pre>\n<p><strong>Downside</strong>: paramaterized build is not as nice. default is not dynamic</p>\n<p><strong>finding a better solution:</strong></p>\n<p>looking at the logs...</p>\n<pre><code class=\"language-text\">00:53:26 $ docker run -t -d -u 1000:1000 bash cf-cli.sh -d jenkins-templates/deploy-params.json -w /home/vagrant/workspace/lar2-seed_jenkins-migration-ICO5IXAUDRSS4U26C74JGCAJHYXPZRHEECFNHNAA5JEOKVASU73A -v /home/vagrant/workspace/lar2-seed_jenkins-migration-ICO5IXAUDRSS4U26C74JGCAJHYXPZRHEECFNHNAA5JEOKVASU73A:/home/vagrant/workspace/lar2-seed_jenkins-migration-ICO5IXAUDRSS4U26C74JGCAJHYXPZRHEECFNHNAA5JEOKVASU73A:rw,z -v /home/vagrant/workspace/lar2-seed_jenkins-migration-ICO5IXAUDRSS4U26C74JGCAJHYXPZRHEECFNHNAA5JEOKVASU73A@tmp:/home/vagrant/workspace/lar2-seed_jenkins-migration-ICO5IXAUDRSS4U26C74JGCAJHYXPZRHEECFNHNAA5JEOKVASU73A@tmp:rw,z -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** mrllsvc/pcf-tools:3 cat\n00:53:26 $ docker top 966271e9c4bf7663017dda99fda1ed3d271794f51b693a220790cb02b961a0e7 -eo pid,comm\n</code></pre>\n<p>jenkins will autocreate and mount the workspace. I do not need to modify the volume or workspace in this case</p>\n<p>however... if i need to use a sub dir as base workspace i have an option that supports relative pathing from workspace root</p>\n<blockquote>\n<p>customWorkspace</p>\n<p>A string. Run the Pipeline or individual<code>stage</code>this<code>agent</code>is applied to within this custom workspace, rather than the default. It can be either a relative path, in which case the custom workspace will be under the workspace root on the node, or an absolute path</p>\n</blockquote>\n<p>this won't solve the above problem since WORKSPACE is created after agent. but will work in other scenarios with other global vars</p>\n<pre><code class=\"language-text\">stage('deploy') {\n    agent {\n        docker {\n            image 'mrllsvc/pcf-tools:3'\n            customWorkspace '$MYENVVAR/blah'\n        }\n    }\n}\n</code></pre>\n<p>for the other example I can change to the sub directory</p>\n<pre><code class=\"language-text\">stage('deploy') {\n    agent {\n        docker {\n            image 'mrllsvc/pcf-tools:3'\n            customWorkspace '$MYENVVAR/blah'\n        }\n    }\n\n    steps {\n        script {\n            dir('jenkins-templates') {\n                sh 'ls -la'\n            }\n        }\n    }\n}\n</code></pre>\n<p><strong>permissions issues</strong></p>\n<p>mounting a volume from the jenkins home can cause permissions issues:</p>\n<p><a href=\"https://support.cloudbees.com/hc/en-us/articles/218583777-How-to-set-user-in-docker-image-\">https://support.cloudbees.com/hc/en-us/articles/218583777-How-to-set-user-in-docker-image-</a></p>\n<p><a href=\"https://github.com/jenkinsci/docker-workflow-plugin/pull/57\">https://github.com/jenkinsci/docker-workflow-plugin/pull/57</a></p>\n<p><a href=\"https://github.com/jenkinsci/docker/issues/165\">https://github.com/jenkinsci/docker/issues/165</a></p>\n<p><a href=\"https://github.com/jenkinsci/docker#usage\">https://github.com/jenkinsci/docker#usage</a></p>\n<blockquote>\n<p>Avoid using a bind mount from a folder on host into</p>\n<p><code>/var/jenkins_home</code></p>\n<p>, as this might result in file permission issue. If you</p>\n<p><em>really</em></p>\n<p>need to bind mount jenkins_home, ensure that directory on host is accessible by the jenkins user in container (jenkins user - uid 1000) or use</p>\n<p><code>-u some_other_user</code></p>\n<p>parameter with</p>\n<p><code>docker run</code></p>\n</blockquote>\n<h2>publish html reports</h2>\n<p><a href=\"https://www.cloudbees.com/blog/publishing-html-reports-pipeline\">https://www.cloudbees.com/blog/publishing-html-reports-pipeline</a></p>\n<h2>pipeline</h2>\n<p><a href=\"https://jenkins.io/doc/pipeline/steps/\">https://jenkins.io/doc/pipeline/steps/</a> - steps reference</p>\n<p><a href=\"https://github.com/jenkinsci/pipeline-examples/tree/master/pipeline-examples\">https://github.com/jenkinsci/pipeline-examples/tree/master/pipeline-examples</a> - pipeline examples</p>\n<p><a href=\"https://jenkins.io/pipeline/getting-started-pipelines/\">https://jenkins.io/pipeline/getting-started-pipelines/</a> - getting started guide</p>\n<h3>cps/@NonCPS</h3>\n<p><a href=\"https://jenkins.io/blog/2017/02/01/pipeline-scalability-best-practice/\">https://jenkins.io/blog/2017/02/01/pipeline-scalability-best-practice/</a> - guide</p>\n<p><a href=\"https://issues.jenkins-ci.org/browse/JENKINS-45904\">https://issues.jenkins-ci.org/browse/JENKINS-45904</a></p>\n<p>Note: When using the @Override chances you will need @NonCPS</p>\n<h4>examples</h4>\n<p>calling code</p>\n<pre><code class=\"language-groovy\">  def message = Notifications.getSuccessMessage(env, currentBuild, pipelineParams)\n  println \"mesage from slackSend: ${message}\"\n//  Message message = new Message(channel: Rooms.NODE_DEFAULT.roomId, text: 'yo3')\n  def payload = JsonOutput.toJson(message)\n  println payload.dump()\n  println payload.toString()\n\n  // method from message class\n  @Override\n  @NonCPS // added in after example\n  String toString() {\n    \"${getClass().getName()}(${text}, ${attachments}, ${channel}, ${channelName})\"\n  }\n</code></pre>\n<p>before adding @NonCPS to @Override methods</p>\n<pre><code class=\"language-bash\">mesage from slackSend: -2014110711\n[Pipeline] echo\n&#x3C;java.lang.String@a6a49095 value=-2014110711 hash=-1499164523>\n[Pipeline] echo\n-2014110711\n[Pipeline] echo\nslack send failed: java.lang.Exception: slack send res.ok: json_not_object\n</code></pre>\n<p>after adding @NonCPS to @Override methods</p>\n<pre><code class=\"language-bash\">mesage from slackSend: com.mrll.javelin.slack.Message(CICD-417: adding NonCPS to override methods&#x3C;br>https://issues.jenkins-ci.org/browse/JENKINS-45904&#x3C;br>An @Override of a method defined in a binary supertype must also be&#x3C;br>marked @NonCPS. Doc&#x3C;br>, [], NODE_DEFAULT, )\n[Pipeline] echo\n&#x3C;java.lang.String@799ce7f9 value={\"attachments\":[],\"text\":\"CICD-417: adding NonCPS to override methods&#x3C;br>https://issues.jenkins-ci.org/browse/JENKINS-45904&#x3C;br>An @Override of a method defined in a binary supertype must also be&#x3C;br>marked @NonCPS. Doc&#x3C;br>\",\"channelName\":\"\",\"channel\":\"NODE_DEFAULT\"} hash=2040326137>\n[Pipeline] echo\n{\"attachments\":[],\"text\":\"CICD-417: adding NonCPS to override methods&#x3C;br>https://issues.jenkins-ci.org/browse/JENKINS-45904&#x3C;br>An @Override of a method defined in a binary supertype must also be&#x3C;br>marked @NonCPS. Doc&#x3C;br>\",\"channelName\":\"\",\"channel\":\"NODE_DEFAULT\"}\n[Pipeline] echo\nslack send failed: java.lang.Exception: slack send res.ok: channel_not_found\n</code></pre>\n<h3>parameter types</h3>\n<p><a href=\"https://github.com/jenkinsci/pipeline-model-definition-plugin/wiki/Parametrized-pipelines\">https://github.com/jenkinsci/pipeline-model-definition-plugin/wiki/Parametrized-pipelines</a></p>\n<h3>generate dsl job</h3>\n<p><a href=\"https://devops.datenkollektiv.de/from-plain-groovy-to-jenkins-job-dsl-a-quantum-jump.html\">https://devops.datenkollektiv.de/from-plain-groovy-to-jenkins-job-dsl-a-quantum-jump.html</a></p>\n<p><a href=\"http://engineering.curalate.com/2016/09/29/programmatic-jenkins-jobs.html\">http://engineering.curalate.com/2016/09/29/programmatic-jenkins-jobs.html</a></p>\n<p><a href=\"https://github.com/SweSri31/JobDsl/blob/b5146c81ce204dec18cb8b898e35994a24d383a8/job-dsl-core/src/test/groovy/javaposse/jobdsl/dsl/DslScriptLoaderSpec.groovy\">https://github.com/SweSri31/JobDsl/blob/b5146c81ce204dec18cb8b898e35994a24d383a8/job-dsl-core/src/test/groovy/javaposse/jobdsl/dsl/DslScriptLoaderSpec.groovy</a></p>\n<pre><code class=\"language-groovy\">import javaposse.jobdsl.dsl.DslScriptLoader\nimport javaposse.jobdsl.plugin.JenkinsJobManagement\n\ndef jobDslScript = new File('/var/jenkins_home/jobs.groovy')\ndef workspace = new File('.')\n\ndef jobManagement = new JenkinsJobManagement(System.out, [:], workspace)\n\nnew DslScriptLoader(jobManagement).runScript(jobDslScript.text)\n</code></pre>\n<pre><code class=\"language-bash\">docker run --detach --volume=$HOME/.gradle:/home/gradle/.gradle -p 5050:5050 ewypych/job-dsl-playground:latest\n</code></pre>\n<h3>tuning</h3>\n<h4>gc</h4>\n<p><a href=\"https://jenkins.io/blog/2016/11/21/gc-tuning/\">https://jenkins.io/blog/2016/11/21/gc-tuning/</a></p>\n<p><a href=\"https://support.cloudbees.com/hc/en-us/articles/229795948-Required-Data-CJP-CJT-Hang-Issue-On-Linux\">https://support.cloudbees.com/hc/en-us/articles/229795948-Required-Data-CJP-CJT-Hang-Issue-On-Linux</a></p>\n<p><a href=\"https://support.cloudbees.com/hc/en-us/articles/115003461772-IO-Troubleshooting-on-Linux\">https://support.cloudbees.com/hc/en-us/articles/115003461772-IO-Troubleshooting-on-Linux</a></p>\n<p><a href=\"https://support.cloudbees.com/hc/en-us/articles/115003461772-IO-Troubleshooting-on-Linux\">https://support.cloudbees.com/hc/en-us/articles/115003461772-IO-Troubleshooting-on-Linux</a></p>\n<h3>cloudbees core</h3>\n<p><a href=\"https://go.cloudbees.com/docs/cloudbees-core/cloud-intro/\">https://go.cloudbees.com/docs/cloudbees-core/cloud-intro/</a></p>\n<h3>jenkins x</h3>\n<p><a href=\"https://jenkins.io/projects/jenkins-x/\">https://jenkins.io/projects/jenkins-x/</a></p>\n<h3>concurrency</h3>\n<p><a href=\"https://jenkins.io/blog/2016/10/16/stage-lock-milestone\">https://jenkins.io/blog/2016/10/16/stage-lock-milestone</a></p>\n<h3>cleanup/backup</h3>\n<p>recreate jenkins config structure only</p>\n<pre><code class=\"language-bash\">find . -name 'config.xml' -exec cp --parents \\{\\} ~/temp/jenkinstest \\;\n</code></pre>\n<p>find string in directory and log it</p>\n<pre><code class=\"language-bash\">grep -R --line-buffered -e 'utils/util' . > findutil.log\n</code></pre>\n<h3>hooks</h3>\n<p><a href=\"https://issues.jenkins-ci.org/browse/JENKINS-43561\">https://issues.jenkins-ci.org/browse/JENKINS-43561</a></p>\n<pre><code>Checking pull request #1044\n    (not from a trusted source)\n      ‘Jenkinsfile’ found\n    Met criteria\nScheduled build for branch: PR-1044\n</code></pre>\n<h2>cloudbees jenkins book</h2>\n<p><a href=\"https://go.cloudbees.com/docs/cloudbees-documentation/cje-user-guide/index.html#nectar-intro\">https://go.cloudbees.com/docs/cloudbees-documentation/cje-user-guide/index.html#nectar-intro</a></p>\n<h2>disk usage</h2>\n<p>find usage</p>\n<pre><code class=\"language-bash\">find $JENKINS_HOME -mindepth 2 -maxdepth 2 -type d -exec du -hs {} \\; > usage.txt\n</code></pre>\n<p>bulk delete jobs</p>\n<p>make sure to reload from disk or restart after</p>\n<pre><code class=\"language-bash\">seq 0 1 300 | xargs rm -rf {}\n</code></pre>","frontmatter":{"date":"February 03, 2019","title":"Jenkins","tags":["CI","CD"]}}},"pageContext":{"slug":"/jenkins/"}},"staticQueryHashes":["1796642556","2356112386","3489759178"],"slicesMap":{}}